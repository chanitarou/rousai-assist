<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>労災申請システム - 休業補償給付請求書 | デジタル庁デザインシステム準拠</title>
    
    <!-- デジタル庁デザインシステム準拠のフォント -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ============================================
           デジタル庁デザインシステム準拠
           Design Tokens & CSS Variables
        ============================================ */
        :root {
            /* カラーパレット - デジタル庁デザインシステム準拠 */
            /* Blue (Primary) */
            --color-blue-50: #EFF6FF;
            --color-blue-100: #DBEAFE;
            --color-blue-200: #BFDBFE;
            --color-blue-300: #93C5FD;
            --color-blue-400: #60A5FA;
            --color-blue-500: #3B82F6;
            --color-blue-600: #2563EB;
            --color-blue-700: #1D4ED8;
            --color-blue-800: #1E40AF;
            --color-blue-900: #1E3A8A;
            --color-blue-950: #172554;

            /* Gray (Solid Gray) */
            --color-gray-50: #F9FAFB;
            --color-gray-100: #F3F4F6;
            --color-gray-200: #E5E7EB;
            --color-gray-300: #D1D5DB;
            --color-gray-400: #9CA3AF;
            --color-gray-500: #6B7280;
            --color-gray-600: #4B5563;
            --color-gray-700: #374151;
            --color-gray-800: #1F2937;
            --color-gray-900: #111827;
            --color-gray-950: #030712;

            /* Semantic Colors */
            --color-error: #DC2626;
            --color-error-bg: #FEF2F2;
            --color-error-border: #FCA5A5;
            --color-success: #16A34A;
            --color-success-bg: #F0FDF4;
            --color-success-border: #86EFAC;
            --color-warning: #D97706;
            --color-warning-bg: #FEF3C7;
            --color-warning-border: #FCD34D;
            --color-info: #0891B2;
            --color-info-bg: #F0FDFA;
            --color-info-border: #67E8F9;

            /* Primary & Secondary Colors */
            --color-primary: #004C8C;
            --color-primary-hover: #003F73;
            --color-secondary: var(--color-blue-100);
            --color-tertiary: var(--color-gray-100);
            --color-background: #FFFFFF;
            --color-surface: var(--color-gray-50);
            --color-text: var(--color-gray-900);
            --color-text-secondary: var(--color-gray-600);
            --color-text-tertiary: var(--color-gray-500);
            --color-border: var(--color-gray-300);

            /* Typography - デジタル庁推奨 */
            --font-family-base: 'Noto Sans JP', -apple-system, BlinkMacSystemFont, 'Helvetica Neue', 'ヒラギノ角ゴ ProN', 'Hiragino Kaku Gothic ProN', 'メイリオ', Meiryo, sans-serif;
            --font-size-xs: 0.75rem;    /* 12px */
            --font-size-sm: 0.875rem;   /* 14px */
            --font-size-base: 1rem;     /* 16px */
            --font-size-lg: 1.125rem;   /* 18px */
            --font-size-xl: 1.25rem;    /* 20px */
            --font-size-2xl: 1.5rem;    /* 24px */
            --font-size-3xl: 1.875rem;  /* 30px */
            --font-size-4xl: 2.25rem;   /* 36px */
            
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-bold: 700;
            
            --line-height-tight: 1.25;
            --line-height-normal: 1.5;
            --line-height-relaxed: 1.75;

            /* Spacing - 8pxベースシステム */
            --spacing-0: 0;
            --spacing-1: 0.25rem;  /* 4px */
            --spacing-2: 0.5rem;   /* 8px */
            --spacing-3: 0.75rem;  /* 12px */
            --spacing-4: 1rem;     /* 16px */
            --spacing-5: 1.25rem;  /* 20px */
            --spacing-6: 1.5rem;   /* 24px */
            --spacing-8: 2rem;     /* 32px */
            --spacing-10: 2.5rem;  /* 40px */
            --spacing-12: 3rem;    /* 48px */
            --spacing-16: 4rem;    /* 64px */

            /* Border Radius */
            --radius-none: 0;
            --radius-sm: 0.125rem;   /* 2px */
            --radius-base: 0.25rem;  /* 4px */
            --radius-md: 0.375rem;   /* 6px */
            --radius-lg: 0.5rem;     /* 8px */
            --radius-xl: 0.75rem;    /* 12px */
            --radius-full: 9999px;

            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-base: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);

            /* Z-index */
            --z-index-dropdown: 1000;
            --z-index-sticky: 1020;
            --z-index-fixed: 1030;
            --z-index-modal-backdrop: 1040;
            --z-index-modal: 1050;
            --z-index-popover: 1060;
            --z-index-tooltip: 1070;

            /* Transitions */
            --transition-fast: 150ms ease-in-out;
            --transition-base: 250ms ease-in-out;
            --transition-slow: 350ms ease-in-out;
        }

        /* ============================================
           リセットスタイル
        ============================================ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* ============================================
           ベーススタイル
        ============================================ */
        body {
            font-family: var(--font-family-base);
            font-size: var(--font-size-base);
            line-height: var(--line-height-normal);
            color: var(--color-text);
            background-color: var(--color-surface);
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* ============================================
           コンテナ
        ============================================ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--spacing-4);
        }

        /* ============================================
           ヘッダー - デジタル庁デザインシステム準拠
        ============================================ */
        .header {
            background-color: var(--color-background);
            border-bottom: 1px solid var(--color-border);
            position: sticky;
            top: 0;
            z-index: var(--z-index-sticky);
        }

        .header-top {
            background-color: var(--color-primary);
            color: white;
            padding: var(--spacing-2) 0;
        }

        .header-top-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: var(--font-size-sm);
        }

        .header-top-content a {
            color: white;
            text-decoration: none;
            margin-left: var(--spacing-6);
            transition: opacity var(--transition-fast);
        }

        .header-top-content a:hover {
            opacity: 0.8;
            text-decoration: underline;
        }

        .header-main {
            padding: var(--spacing-6) 0;
        }

        .header-title {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-primary);
            margin-bottom: var(--spacing-2);
        }

        .header-subtitle {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
        }

        /* ============================================
           プログレスインジケーター - デジタル庁デザインシステム準拠
        ============================================ */
        .progress-section {
            background-color: var(--color-background);
            border-bottom: 1px solid var(--color-border);
            padding: var(--spacing-6) 0;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-4);
        }

        .progress-title {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-medium);
            color: var(--color-text);
        }

        .progress-counter {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            background-color: var(--color-gray-100);
            padding: var(--spacing-1) var(--spacing-3);
            border-radius: var(--radius-full);
        }

        .progress-bar {
            background-color: var(--color-gray-200);
            height: 8px;
            border-radius: var(--radius-base);
            position: relative;
            overflow: hidden;
        }

        .progress-bar-fill {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            background-color: var(--color-primary);
            border-radius: var(--radius-base);
            transition: width var(--transition-base);
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin-top: var(--spacing-6);
            position: relative;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            flex: 1;
        }

        .progress-step-indicator {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-full);
            background-color: var(--color-gray-300);
            color: var(--color-gray-600);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: var(--font-weight-medium);
            font-size: var(--font-size-sm);
            margin-bottom: var(--spacing-2);
            position: relative;
            z-index: 2;
            transition: all var(--transition-base);
        }

        .progress-step.active .progress-step-indicator {
            background-color: var(--color-primary);
            color: white;
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1);
        }

        .progress-step.completed .progress-step-indicator {
            background-color: var(--color-success);
            color: white;
        }

        .progress-step-label {
            font-size: var(--font-size-xs);
            color: var(--color-text-secondary);
            text-align: center;
            max-width: 80px;
        }

        .progress-step.active .progress-step-label {
            color: var(--color-primary);
            font-weight: var(--font-weight-medium);
        }

        .progress-step-line {
            position: absolute;
            top: 16px;
            left: 50%;
            width: 100%;
            height: 2px;
            background-color: var(--color-gray-300);
            z-index: 1;
        }

        .progress-step:last-child .progress-step-line {
            display: none;
        }

        .progress-step.completed .progress-step-line {
            background-color: var(--color-success);
        }

        /* ============================================
           メインコンテンツ
        ============================================ */
        .main-content {
            padding: var(--spacing-8) 0;
        }

        /* ============================================
           カード - デジタル庁デザインシステム準拠
        ============================================ */
        .card {
            background-color: var(--color-background);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: var(--spacing-6);
            margin-bottom: var(--spacing-6);
            box-shadow: var(--shadow-sm);
        }

        .card-header {
            border-bottom: 2px solid var(--color-gray-200);
            padding-bottom: var(--spacing-4);
            margin-bottom: var(--spacing-6);
        }

        .card-title {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-text);
            margin-bottom: var(--spacing-2);
        }

        .card-description {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
        }

        /* ============================================
           フォーム要素 - デジタル庁デザインシステム準拠
        ============================================ */
        .form-group {
            margin-bottom: var(--spacing-6);
        }

        .form-label {
            display: block;
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            color: var(--color-text);
            margin-bottom: var(--spacing-2);
        }

        .form-label-required::after {
            content: ' *';
            color: var(--color-error);
        }

        .form-help {
            font-size: var(--font-size-xs);
            color: var(--color-text-tertiary);
            margin-top: var(--spacing-1);
        }

        .form-input {
            width: 100%;
            padding: var(--spacing-3) var(--spacing-4);
            font-size: var(--font-size-base);
            font-family: var(--font-family-base);
            color: var(--color-text);
            background-color: var(--color-background);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            transition: all var(--transition-fast);
            appearance: none;
            -webkit-appearance: none;
        }

        .form-input:hover {
            border-color: var(--color-gray-400);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-input:disabled {
            background-color: var(--color-gray-100);
            color: var(--color-gray-500);
            cursor: not-allowed;
        }

        .form-input.error {
            border-color: var(--color-error);
            background-color: var(--color-error-bg);
        }

        .form-input.error:focus {
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-select {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
            background-position: right var(--spacing-3) center;
            background-repeat: no-repeat;
            background-size: 20px;
            padding-right: var(--spacing-10);
        }

        /* Radio & Checkbox */
        .form-radio-group,
        .form-checkbox-group {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-3);
        }

        .form-radio-inline,
        .form-checkbox-inline {
            display: flex;
            flex-direction: row;
            gap: var(--spacing-4);
        }

        .form-radio-item,
        .form-checkbox-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-2);
        }

        .form-radio,
        .form-checkbox {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
            cursor: pointer;
            accent-color: var(--color-primary);
        }

        .form-radio-label,
        .form-checkbox-label {
            cursor: pointer;
            font-size: var(--font-size-base);
        }

        /* Form Grid */
        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-4);
        }

        .form-row-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--spacing-4);
        }

        @media (max-width: 768px) {
            .form-row,
            .form-row-3 {
                grid-template-columns: 1fr;
            }
        }

        /* ============================================
           エラーメッセージ - デジタル庁デザインシステム準拠
        ============================================ */
        .error-message {
            display: none;
            margin-top: var(--spacing-2);
            padding: var(--spacing-2) var(--spacing-3);
            background-color: var(--color-error-bg);
            border-left: 3px solid var(--color-error);
            border-radius: var(--radius-base);
            color: var(--color-error);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
        }

        .error-message.show {
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-2);
        }

        .error-message::before {
            content: '⚠';
            flex-shrink: 0;
        }

        .error-summary {
            display: none;
            padding: var(--spacing-4);
            background-color: var(--color-error-bg);
            border: 2px solid var(--color-error);
            border-radius: var(--radius-base);
            margin-bottom: var(--spacing-6);
            box-shadow: 0 4px 6px rgba(220, 38, 38, 0.1);
        }

        .error-summary.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .error-summary-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-2);
            margin-bottom: var(--spacing-3);
        }

        .error-summary-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
            color: var(--color-error);
        }

        .error-summary-title {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-bold);
            color: var(--color-error);
        }

        .error-summary-description {
            font-size: var(--font-size-sm);
            color: var(--color-error);
            margin-bottom: var(--spacing-3);
        }

        .error-summary-list {
            list-style: none;
            margin: 0;
            padding: 0;
            color: var(--color-error);
        }

        .error-summary-list li {
            padding: var(--spacing-2) var(--spacing-3);
            margin-bottom: var(--spacing-1);
            background-color: white;
            border-radius: var(--radius-base);
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-2);
        }

        .error-summary-list li::before {
            content: '•';
            font-weight: bold;
            flex-shrink: 0;
        }

        /* ============================================
           ボタン - デジタル庁デザインシステム準拠
        ============================================ */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-2);
            padding: var(--spacing-3) var(--spacing-6);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            font-family: var(--font-family-base);
            border-radius: var(--radius-base);
            border: none;
            cursor: pointer;
            transition: all var(--transition-fast);
            text-decoration: none;
            min-height: 44px; /* アクセシビリティ: 最小タッチターゲット */
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Primary Button */
        .btn-primary {
            background-color: var(--color-primary);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background-color: var(--color-primary-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-primary:active:not(:disabled) {
            transform: translateY(0);
        }

        /* Secondary Button */
        .btn-secondary {
            background-color: var(--color-gray-200);
            color: var(--color-text);
        }

        .btn-secondary:hover:not(:disabled) {
            background-color: var(--color-gray-300);
        }

        /* Success Button */
        .btn-success {
            background-color: var(--color-success);
            color: white;
        }

        .btn-success:hover:not(:disabled) {
            background-color: #15803d;
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        /* Outline Button */
        .btn-outline {
            background-color: transparent;
            color: var(--color-primary);
            border: 2px solid var(--color-primary);
        }

        .btn-outline:hover:not(:disabled) {
            background-color: var(--color-primary);
            color: white;
        }

        /* Button Group */
        .btn-group {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-4);
            margin-top: var(--spacing-8);
            padding-top: var(--spacing-6);
            border-top: 1px solid var(--color-border);
        }

        /* ============================================
           バッジ - デジタル庁デザインシステム準拠
        ============================================ */
        .badge {
            display: inline-block;
            padding: var(--spacing-1) var(--spacing-3);
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-medium);
            border-radius: var(--radius-full);
            background-color: var(--color-gray-200);
            color: var(--color-text);
        }

        .badge-primary {
            background-color: var(--color-secondary);
            color: var(--color-primary);
        }

        .badge-success {
            background-color: var(--color-success-bg);
            color: var(--color-success);
        }

        .badge-warning {
            background-color: var(--color-warning-bg);
            color: var(--color-warning);
        }

        .badge-error {
            background-color: var(--color-error-bg);
            color: var(--color-error);
        }

        /* ============================================
           ノティフィケーションバナー
        ============================================ */
        .notification {
            padding: var(--spacing-4);
            border-radius: var(--radius-base);
            margin-bottom: var(--spacing-4);
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-3);
        }

        .notification-info {
            background-color: var(--color-info-bg);
            border: 1px solid var(--color-info-border);
            color: var(--color-info);
        }

        .notification-warning {
            background-color: var(--color-warning-bg);
            border: 1px solid var(--color-warning-border);
            color: var(--color-warning);
        }

        .notification-icon {
            flex-shrink: 0;
            width: 20px;
            height: 20px;
        }

        /* ============================================
           完了画面
        ============================================ */
        .completion-screen {
            text-align: center;
            padding: var(--spacing-12) var(--spacing-6);
        }

        .completion-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto var(--spacing-6);
            background-color: var(--color-success-bg);
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--color-success);
            font-size: var(--font-size-4xl);
        }

        .completion-title {
            font-size: var(--font-size-3xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-text);
            margin-bottom: var(--spacing-4);
        }

        .completion-message {
            font-size: var(--font-size-lg);
            color: var(--color-text-secondary);
            margin-bottom: var(--spacing-8);
        }

        /* ============================================
           ローディング
        ============================================ */
        .loading {
            display: none;
            text-align: center;
            padding: var(--spacing-8);
        }

        .loading.active {
            display: block;
        }

        .spinner {
            width: 48px;
            height: 48px;
            margin: 0 auto var(--spacing-4);
            border: 4px solid var(--color-gray-200);
            border-top-color: var(--color-primary);
            border-radius: var(--radius-full);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ============================================
           ファイルアップロード
        ============================================ */
        .file-upload-area {
            border: 2px dashed var(--color-gray-300);
            border-radius: var(--radius-lg);
            padding: var(--spacing-8);
            text-align: center;
            background-color: var(--color-gray-50);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .file-upload-area:hover {
            border-color: var(--color-primary);
            background-color: var(--color-blue-50);
        }

        .file-upload-area.dragover {
            border-color: var(--color-primary);
            background-color: var(--color-secondary);
        }

        .file-upload-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto var(--spacing-4);
            color: var(--color-gray-400);
        }

        .file-upload-text {
            color: var(--color-text);
            margin-bottom: var(--spacing-2);
        }

        .file-upload-hint {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
        }

        .file-list {
            margin-top: var(--spacing-4);
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-3);
            background-color: var(--color-gray-50);
            border-radius: var(--radius-base);
            margin-bottom: var(--spacing-2);
        }

        .file-item-name {
            display: flex;
            align-items: center;
            gap: var(--spacing-2);
            color: var(--color-text);
        }

        .file-item-remove {
            padding: var(--spacing-1) var(--spacing-2);
            background-color: transparent;
            border: 1px solid var(--color-gray-300);
            border-radius: var(--radius-base);
            color: var(--color-text-secondary);
            font-size: var(--font-size-sm);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .file-item-remove:hover {
            background-color: var(--color-error-bg);
            border-color: var(--color-error);
            color: var(--color-error);
        }

        /* ============================================
           ステップ表示
        ============================================ */
        .step-content {
            display: none;
        }

        .step-content.active {
            display: block;
            animation: fadeIn var(--transition-base);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ============================================
           レスポンシブデザイン
        ============================================ */
        @media (max-width: 768px) {
            .container {
                padding: 0 var(--spacing-3);
            }

            .progress-steps {
                overflow-x: auto;
                padding-bottom: var(--spacing-2);
            }

            .progress-step-label {
                display: none;
            }

            .btn-group {
                flex-direction: column-reverse;
            }

            .btn {
                width: 100%;
            }
        }

        /* ============================================
           アクセシビリティ
        ============================================ */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        :focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: 2px;
        }

        /* ============================================
           印刷スタイル
        ============================================ */
        @media print {
            .header-top,
            .btn-group,
            .progress-section {
                display: none;
            }

            body {
                background: white;
            }

            .card {
                box-shadow: none;
                border: 1px solid #000;
            }
        }
    </style>
</head>
<body>
    <!-- ヘッダー -->
    <header class="header">
        <div class="header-top">
            <div class="container">
                <div class="header-top-content">
                    <span>厚生労働省 労働基準局</span>
                    <nav>
                        <a href="労災アシストTOP画面.html" aria-label="ホームへ戻る">ホーム</a>
                        <a href="#" aria-label="ヘルプを表示">ヘルプ</a>
                        <a href="#" onclick="logout()" aria-label="ログアウト">ログアウト</a>
                    </nav>
                </div>
            </div>
        </div>
        <div class="header-main">
            <div class="container">
                <h1 class="header-title">労災保険給付申請 - 休業補償給付請求書</h1>
                <p class="header-subtitle">様式第8号 - 業務災害用</p>
            </div>
        </div>
    </header>

    <!-- プログレスインジケーター -->
    <section class="progress-section">
        <div class="container">
            <div class="progress-header">
                <h2 class="progress-title">申請進捗状況</h2>
                <span class="progress-counter">
                    ステップ <span id="currentStep">1</span> / <span id="totalSteps">10</span>
                </span>
            </div>
            
            <div class="progress-bar">
                <div class="progress-bar-fill" id="progressBar" style="width: 10%;"></div>
            </div>
            
            <div class="progress-steps" id="progressSteps">
                <!-- JavaScriptで動的に生成 -->
            </div>
        </div>
    </section>

    <!-- メインコンテンツ -->
    <main class="main-content">
        <div class="container">
            <!-- ステップ1: 労働者基本情報 -->
            <div class="step-content active" id="step-1">
                <div class="card">
                    <div class="card-header">
                        <span class="badge badge-primary">被災労働者</span>
                        <h2 class="card-title">労働者基本情報</h2>
                        <p class="card-description">申請者の基本情報を入力してください</p>
                    </div>

                    <div class="error-summary" id="errorSummary1">
                        <div class="error-summary-header">
                            <svg class="error-summary-icon" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
                            </svg>
                            <h3 class="error-summary-title">入力内容にエラーがあります</h3>
                        </div>
                        <p class="error-summary-description">以下の項目を修正してください：</p>
                        <ul class="error-summary-list" id="errorList1"></ul>
                    </div>

                    <form>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="lastName" class="form-label form-label-required">姓</label>
                                <input type="text" id="lastName" class="form-input" placeholder="例：山田" aria-required="true">
                                <div class="error-message" id="lastName-error"></div>
                            </div>
                            <div class="form-group">
                                <label for="firstName" class="form-label form-label-required">名</label>
                                <input type="text" id="firstName" class="form-input" placeholder="例：太郎" aria-required="true">
                                <div class="error-message" id="firstName-error"></div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="lastNameKana" class="form-label form-label-required">姓（フリガナ）</label>
                                <input type="text" id="lastNameKana" class="form-input" placeholder="例：ヤマダ" aria-required="true">
                                <div class="error-message" id="lastNameKana-error"></div>
                            </div>
                            <div class="form-group">
                                <label for="firstNameKana" class="form-label form-label-required">名（フリガナ）</label>
                                <input type="text" id="firstNameKana" class="form-input" placeholder="例：タロウ" aria-required="true">
                                <div class="error-message" id="firstNameKana-error"></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label form-label-required">性別</label>
                            <div class="form-radio-inline">
                                <div class="form-radio-item">
                                    <input type="radio" id="male" name="gender" value="male" class="form-radio">
                                    <label for="male" class="form-radio-label">男性</label>
                                </div>
                                <div class="form-radio-item">
                                    <input type="radio" id="female" name="gender" value="female" class="form-radio">
                                    <label for="female" class="form-radio-label">女性</label>
                                </div>
                                <div class="form-radio-item">
                                    <input type="radio" id="other" name="gender" value="other" class="form-radio">
                                    <label for="other" class="form-radio-label">その他</label>
                                </div>
                            </div>
                            <div class="error-message" id="gender-error"></div>
                        </div>

                        <div class="form-group">
                            <label for="birthDate" class="form-label form-label-required">生年月日</label>
                            <input type="date" id="birthDate" class="form-input" aria-required="true">
                            <div class="error-message" id="birthDate-error"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label form-label-required">電話番号</label>
                            <div style="display: flex; gap: var(--spacing-2); align-items: center;">
                                <input type="text" id="tel1" class="form-input" placeholder="080" maxlength="5" style="max-width: 100px;" aria-required="true">
                                <span style="font-weight: bold;">-</span>
                                <input type="text" id="tel2" class="form-input" placeholder="1234" maxlength="4" style="max-width: 100px;" aria-required="true">
                                <span style="font-weight: bold;">-</span>
                                <input type="text" id="tel3" class="form-input" placeholder="5678" maxlength="4" style="max-width: 100px;" aria-required="true">
                            </div>
                            <p class="form-help">半角数字で入力してください（ハイフンなし）</p>
                            <div class="error-message" id="tel-error"></div>
                        </div>

                        <div class="form-group">
                            <label for="postalCode" class="form-label form-label-required">郵便番号</label>
                            <div style="display: flex; gap: var(--spacing-2); align-items: center;">
                                <input type="text" id="postalCode" class="form-input" placeholder="例：123-4567" style="max-width: 200px;" aria-required="true">
                                <button type="button" class="btn btn-secondary" onclick="searchAddress()">住所検索</button>
                            </div>
                            <div class="error-message" id="postalCode-error"></div>
                        </div>

                        <div class="form-group">
                            <label for="address1" class="form-label form-label-required">住所（都道府県・市区町村）</label>
                            <input type="text" id="address1" class="form-input" placeholder="郵便番号検索ボタンで自動入力されます" aria-required="true">
                            <p class="form-help">郵便番号検索ボタンを押すと自動入力されます</p>
                            <div class="error-message" id="address1-error"></div>
                        </div>

                        <div class="form-group">
                            <label for="address2" class="form-label form-label-required">住所（番地・建物名等）</label>
                            <input type="text" id="address2" class="form-input" placeholder="例：1-2-2 霞が関ビル3階" aria-required="true">
                            <p class="form-help">番地、建物名、部屋番号などを入力してください</p>
                            <div class="error-message" id="address2-error"></div>
                        </div>
                    </form>

                    <div class="btn-group">
                        <button class="btn btn-secondary" disabled>前へ</button>
                        <button class="btn btn-primary" onclick="nextStep()">次へ</button>
                    </div>
                </div>
            </div>

            <!-- ステップ2: 労働保険番号 -->
            <div class="step-content" id="step-2">
                <div class="card">
                    <div class="card-header">
                        <span class="badge badge-primary">被災労働者</span>
                        <h2 class="card-title">労働保険番号・職種情報</h2>
                        <p class="card-description">労働保険番号と職種情報を入力してください</p>
                    </div>

                    <div class="error-summary" id="errorSummary2">
                        <div class="error-summary-header">
                            <svg class="error-summary-icon" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
                            </svg>
                            <h3 class="error-summary-title">入力内容にエラーがあります</h3>
                        </div>
                        <p class="error-summary-description">以下の項目を修正してください：</p>
                        <ul class="error-summary-list" id="errorList2"></ul>
                    </div>

                    <form>
                        <div class="form-group">
                            <label class="form-label form-label-required">労働保険番号</label>
                            <p class="form-help">会社から提供される14桁の番号です（11桁-3桁の形式）</p>
                            <div style="display: flex; gap: var(--spacing-2); align-items: center;">
                                <div style="flex: 1; max-width: 300px;">
                                    <label for="insuranceMain" class="sr-only">労働保険番号（前半11桁）</label>
                                    <input type="text" id="insuranceMain" class="form-input" placeholder="12345678901" maxlength="11" aria-required="true">
                                </div>
                                <span style="font-weight: bold;">-</span>
                                <div style="flex: 0 0 120px;">
                                    <label for="insuranceBranch" class="sr-only">労働保険番号（後半3桁）</label>
                                    <input type="text" id="insuranceBranch" class="form-input" placeholder="001" maxlength="3" aria-required="true">
                                </div>
                            </div>
                            <div class="error-message" id="insurance-error"></div>
                        </div>

                        <div class="form-group">
                            <label for="occupation" class="form-label form-label-required">職種</label>
                            <input type="text" id="occupation" class="form-input" placeholder="例：製造業、事務職、建設作業員">
                            <div class="error-message" id="occupation-error"></div>
                        </div>

                        <div class="form-group">
                            <label for="averageWage" class="form-label form-label-required">平均賃金（日額）</label>
                            <div style="display: flex; gap: var(--spacing-2); align-items: center;">
                                <input type="number" id="averageWage" class="form-input" placeholder="10000" style="max-width: 200px;">
                                <span>円</span>
                            </div>
                            <p class="form-help">直近3か月の平均日額賃金を入力してください</p>
                            <div class="error-message" id="averageWage-error"></div>
                        </div>
                    </form>

                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="previousStep()">前へ</button>
                        <button class="btn btn-primary" onclick="nextStep()">次へ</button>
                    </div>
                </div>
            </div>

            <!-- ステップ3: 災害情報 -->
            <div class="step-content" id="step-3">
                <div class="card">
                    <div class="card-header">
                        <span class="badge badge-primary">被災労働者</span>
                        <h2 class="card-title">災害情報</h2>
                        <p class="card-description">労働災害の詳細情報を入力してください</p>
                    </div>

                    <div class="error-summary" id="errorSummary3">
                        <div class="error-summary-header">
                            <svg class="error-summary-icon" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
                            </svg>
                            <h3 class="error-summary-title">入力内容にエラーがあります</h3>
                        </div>
                        <p class="error-summary-description">以下の項目を修正してください：</p>
                        <ul class="error-summary-list" id="errorList3"></ul>
                    </div>

                    <form>
                        <div class="form-group">
                            <label for="injuryDate" class="form-label form-label-required">負傷または発病年月日</label>
                            <input type="date" id="injuryDate" class="form-input">
                            <div class="error-message" id="injuryDate-error"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label form-label-required">災害発生時刻</label>
                            <div class="form-row">
                                <div>
                                    <label for="injuryHour" class="sr-only">時</label>
                                    <select id="injuryHour" class="form-input form-select">
                                        <option value="">時を選択</option>
                                        <option value="0">0時</option>
                                        <option value="1">1時</option>
                                        <option value="2">2時</option>
                                        <option value="3">3時</option>
                                        <option value="4">4時</option>
                                        <option value="5">5時</option>
                                        <option value="6">6時</option>
                                        <option value="7">7時</option>
                                        <option value="8">8時</option>
                                        <option value="9">9時</option>
                                        <option value="10">10時</option>
                                        <option value="11">11時</option>
                                        <option value="12">12時</option>
                                        <option value="13">13時</option>
                                        <option value="14">14時</option>
                                        <option value="15">15時</option>
                                        <option value="16">16時</option>
                                        <option value="17">17時</option>
                                        <option value="18">18時</option>
                                        <option value="19">19時</option>
                                        <option value="20">20時</option>
                                        <option value="21">21時</option>
                                        <option value="22">22時</option>
                                        <option value="23">23時</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="injuryMinute" class="sr-only">分</label>
                                    <select id="injuryMinute" class="form-input form-select">
                                        <option value="">分を選択</option>
                                        <option value="0">00分</option>
                                        <option value="15">15分</option>
                                        <option value="30">30分</option>
                                        <option value="45">45分</option>
                                    </select>
                                </div>
                            </div>
                            <div class="error-message" id="injuryTime-error"></div>
                        </div>

                        <div class="form-group">
                            <label for="accidentLocation" class="form-label form-label-required">災害発生場所</label>
                            <input type="text" id="accidentLocation" class="form-input" placeholder="例：工場内第2作業場">
                            <div class="error-message" id="accidentLocation-error"></div>
                        </div>

                        <div class="form-group">
                            <label for="accidentDescription" class="form-label form-label-required">災害発生状況</label>
                            <textarea id="accidentDescription" class="form-input form-textarea" rows="4" placeholder="災害が発生した状況を詳しく記入してください"></textarea>
                            <p class="form-help">いつ、どこで、何をしている時に、どのような災害が発生したか、具体的に記入してください（最低20文字以上）</p>
                            <div class="error-message" id="accidentDescription-error"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label form-label-required">休業期間</label>
                            <div class="form-row">
                                <div>
                                    <label for="leaveStartDate" class="form-label">開始日</label>
                                    <input type="date" id="leaveStartDate" class="form-input">
                                </div>
                                <div>
                                    <label for="leaveEndDate" class="form-label">終了日（予定）</label>
                                    <input type="date" id="leaveEndDate" class="form-input">
                                </div>
                            </div>
                            <div class="error-message" id="leavePeriod-error"></div>
                        </div>
                    </form>

                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="previousStep()">前へ</button>
                        <button class="btn btn-primary" onclick="nextStep()">次へ</button>
                    </div>
                </div>
            </div>

            <!-- ステップ4: 振込先情報 -->
            <div class="step-content" id="step-4">
                <div class="card">
                    <div class="card-header">
                        <span class="badge badge-primary">被災労働者</span>
                        <h2 class="card-title">振込先情報</h2>
                        <p class="card-description">給付金の振込先口座を入力してください</p>
                    </div>

                    <div class="error-summary" id="errorSummary4">
                        <div class="error-summary-header">
                            <svg class="error-summary-icon" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
                            </svg>
                            <h3 class="error-summary-title">入力内容にエラーがあります</h3>
                        </div>
                        <p class="error-summary-description">以下の項目を修正してください：</p>
                        <ul class="error-summary-list" id="errorList4"></ul>
                    </div>

                    <form>
                        <div class="notification notification-info">
                            <svg class="notification-icon" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                            </svg>
                            <div>
                                <strong>振込先について</strong>
                                <p style="margin-top: var(--spacing-1); font-size: var(--font-size-sm);">
                                    ご本人名義の口座を入力してください。
                                </p>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="bankName" class="form-label form-label-required">金融機関名</label>
                            <input type="text" id="bankName" class="form-input" placeholder="例：三菱UFJ銀行、みずほ銀行" aria-required="true">
                            <div class="error-message" id="bankName-error"></div>
                        </div>

                        <div class="form-group">
                            <label for="branchName" class="form-label form-label-required">支店名</label>
                            <input type="text" id="branchName" class="form-input" placeholder="例：本店、東京支店" aria-required="true">
                            <div class="error-message" id="branchName-error"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label form-label-required">口座種別</label>
                            <div class="form-radio-inline">
                                <div class="form-radio-item">
                                    <input type="radio" id="accountTypeOrdinary" name="accountType" value="ordinary" class="form-radio">
                                    <label for="accountTypeOrdinary" class="form-radio-label">普通</label>
                                </div>
                                <div class="form-radio-item">
                                    <input type="radio" id="accountTypeCurrent" name="accountType" value="current" class="form-radio">
                                    <label for="accountTypeCurrent" class="form-radio-label">当座</label>
                                </div>
                                <div class="form-radio-item">
                                    <input type="radio" id="accountTypeSavings" name="accountType" value="savings" class="form-radio">
                                    <label for="accountTypeSavings" class="form-radio-label">貯蓄</label>
                                </div>
                            </div>
                            <div class="error-message" id="accountType-error"></div>
                        </div>

                        <div class="form-group">
                            <label for="accountNumber" class="form-label form-label-required">口座番号</label>
                            <input type="text" id="accountNumber" class="form-input" placeholder="例：1234567（7桁以内）" maxlength="8" aria-required="true">
                            <p class="form-help">半角数字で入力してください（通常7桁）</p>
                            <div class="error-message" id="accountNumber-error"></div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="accountHolderLastNameKana" class="form-label form-label-required">口座名義人 姓（カナ）</label>
                                <input type="text" id="accountHolderLastNameKana" class="form-input" placeholder="例：ヤマダ" aria-required="true">
                                <div class="error-message" id="accountHolderLastNameKana-error"></div>
                            </div>
                            <div class="form-group">
                                <label for="accountHolderFirstNameKana" class="form-label form-label-required">口座名義人 名（カナ）</label>
                                <input type="text" id="accountHolderFirstNameKana" class="form-input" placeholder="例：タロウ" aria-required="true">
                                <div class="error-message" id="accountHolderFirstNameKana-error"></div>
                            </div>
                        </div>
                        <p class="form-help" style="margin-top: calc(-1 * var(--spacing-4)); margin-bottom: var(--spacing-4);">全角カタカナで入力してください</p>
                    </form>

                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="previousStep()">前へ</button>
                        <button class="btn btn-primary" onclick="nextStep()">次へ</button>
                    </div>
                </div>
            </div>

            <!-- ステップ5: 添付書類 -->
            <div class="step-content" id="step-5">
                <div class="card">
                    <div class="card-header">
                        <span class="badge badge-primary">被災労働者</span>
                        <h2 class="card-title">添付書類</h2>
                        <p class="card-description">必要な書類をアップロードしてください</p>
                    </div>

                    <form>
                        <div class="notification notification-warning">
                            <svg class="notification-icon" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                            </svg>
                            <div>
                                <strong>添付書類について</strong>
                                <ul style="margin-top: var(--spacing-2); padding-left: var(--spacing-4); font-size: var(--font-size-sm);">
                                    <li>ファイル形式: PDF, JPG, PNG（1ファイル最大10MB）</li>
                                    <li>必要に応じて診断書、レントゲン写真などを添付してください</li>
                                    <li>書類は後からでも追加可能です</li>
                                </ul>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">診断書・医師の意見書</label>
                            <div class="file-upload-area" onclick="document.getElementById('medicalCertificate').click()">
                                <svg class="file-upload-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                                </svg>
                                <p class="file-upload-text">クリックしてファイルを選択</p>
                                <p class="file-upload-hint">またはドラッグ＆ドロップ</p>
                            </div>
                            <input type="file" id="medicalCertificate" style="display: none;" accept=".pdf,.jpg,.jpeg,.png" multiple>
                            <div class="file-list" id="medicalCertificateList"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">その他の添付書類（任意）</label>
                            <div class="file-upload-area" onclick="document.getElementById('otherDocuments').click()">
                                <svg class="file-upload-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                                </svg>
                                <p class="file-upload-text">クリックしてファイルを選択</p>
                                <p class="file-upload-hint">またはドラッグ＆ドロップ</p>
                            </div>
                            <input type="file" id="otherDocuments" style="display: none;" accept=".pdf,.jpg,.jpeg,.png" multiple>
                            <div class="file-list" id="otherDocumentsList"></div>
                        </div>
                    </form>

                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="previousStep()">前へ</button>
                        <button class="btn btn-primary" onclick="nextStep()">次へ</button>
                    </div>
                </div>
            </div>

            <!-- ステップ6-9: 簡易実装 -->
            <div class="step-content" id="step-6">
                <div class="card">
                    <div class="card-header">
                        <span class="badge badge-warning">事業主</span>
                        <h2 class="card-title">事業主情報</h2>
                        <p class="card-description">事業主による入力セクション（実装予定）</p>
                    </div>
                    <div class="notification notification-info">
                        <svg class="notification-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        <p>このセクションは事業主が入力します。現在は開発中のため、スキップできます。</p>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="previousStep()">前へ</button>
                        <button class="btn btn-primary" onclick="nextStep()">次へ（スキップ）</button>
                    </div>
                </div>
            </div>

            <div class="step-content" id="step-7">
                <div class="card">
                    <div class="card-header">
                        <span class="badge badge-warning">事業主</span>
                        <h2 class="card-title">事業主証明</h2>
                        <p class="card-description">事業主による証明セクション（実装予定）</p>
                    </div>
                    <div class="notification notification-info">
                        <svg class="notification-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        <p>このセクションは事業主が入力します。現在は開発中のため、スキップできます。</p>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="previousStep()">前へ</button>
                        <button class="btn btn-primary" onclick="nextStep()">次へ（スキップ）</button>
                    </div>
                </div>
            </div>

            <div class="step-content" id="step-8">
                <div class="card">
                    <div class="card-header">
                        <span class="badge badge-success">医療機関</span>
                        <h2 class="card-title">医療機関情報</h2>
                        <p class="card-description">医療機関による入力セクション（実装予定）</p>
                    </div>
                    <div class="notification notification-info">
                        <svg class="notification-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        <p>このセクションは医療機関が入力します。現在は開発中のため、スキップできます。</p>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="previousStep()">前へ</button>
                        <button class="btn btn-primary" onclick="nextStep()">次へ（スキップ）</button>
                    </div>
                </div>
            </div>

            <div class="step-content" id="step-9">
                <div class="card">
                    <div class="card-header">
                        <span class="badge badge-success">医療機関</span>
                        <h2 class="card-title">診断証明</h2>
                        <p class="card-description">医療機関による診断証明セクション（実装予定）</p>
                    </div>
                    <div class="notification notification-info">
                        <svg class="notification-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        <p>このセクションは医療機関が入力します。現在は開発中のため、スキップできます。</p>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="previousStep()">前へ</button>
                        <button class="btn btn-primary" onclick="nextStep()">次へ（スキップ）</button>
                    </div>
                </div>
            </div>

            <!-- ステップ10: 確認・提出 -->
            <div class="step-content" id="step-10">
                <div class="card">
                    <div class="card-header">
                        <span class="badge badge-primary">被災労働者</span>
                        <h2 class="card-title">申請内容の確認</h2>
                        <p class="card-description">入力内容を確認して申請を完了してください</p>
                    </div>

                    <div class="notification notification-warning">
                        <svg class="notification-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                        </svg>
                        <div>
                            <strong>申請前の確認事項</strong>
                            <ul style="margin-top: var(--spacing-2); padding-left: var(--spacing-4);">
                                <li>入力内容に誤りがないことを確認しました</li>
                                <li>必要な書類をすべて添付しました</li>
                                <li>事業主と医療機関の証明を取得しました</li>
                            </ul>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="form-checkbox-item">
                            <input type="checkbox" id="finalConfirm" class="form-checkbox">
                            <label for="finalConfirm" class="form-checkbox-label">
                                <strong>上記の内容で間違いないことを確認し、労災保険給付を申請します</strong>
                            </label>
                        </div>
                    </div>

                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="previousStep()">前へ</button>
                        <button class="btn btn-success" onclick="submitApplication()">申請する</button>
                    </div>
                </div>
            </div>

            <!-- 完了画面 -->
            <div class="step-content" id="completion">
                <div class="card">
                    <div class="completion-screen">
                        <div class="completion-icon">✓</div>
                        <h2 class="completion-title">申請が完了しました</h2>
                        <p class="completion-message">
                            労災保険給付申請を受け付けました。<br>
                            申請番号: <strong>2025-001234</strong>
                        </p>
                        
                        <div class="btn-group" style="justify-content: center;">
                            <button class="btn btn-outline" onclick="window.print()">申請書を印刷</button>
                            <button class="btn btn-primary" onclick="location.href='労災アシストTOP画面.html'">ホームに戻る</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ローディング -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>処理中...</p>
            </div>
        </div>
    </main>

    <script>
        // グローバル変数
        let currentStep = 1;
        const totalSteps = 10;
        let formData = {};

        // ステップ情報の定義
        const steps = [
            { id: 1, label: '基本情報', role: 'worker' },
            { id: 2, label: '保険番号', role: 'worker' },
            { id: 3, label: '災害情報', role: 'worker' },
            { id: 4, label: '振込先', role: 'worker' },
            { id: 5, label: '添付書類', role: 'worker' },
            { id: 6, label: '事業主情報', role: 'employer' },
            { id: 7, label: '事業主証明', role: 'employer' },
            { id: 8, label: '医療機関', role: 'medical' },
            { id: 9, label: '診断証明', role: 'medical' },
            { id: 10, label: '確認・提出', role: 'worker' }
        ];

        // 初期化
        document.addEventListener('DOMContentLoaded', function() {
            initializeProgress();
            loadFormData();
            setupAutoSave();
            setupRealtimeValidation();
            setupFileUpload();
        });

        // プログレスステップの初期化
        function initializeProgress() {
            const progressSteps = document.getElementById('progressSteps');
            progressSteps.innerHTML = '';

            steps.forEach((step, index) => {
                const stepDiv = document.createElement('div');
                stepDiv.className = 'progress-step';
                stepDiv.id = `progress-${step.id}`;

                if (step.id === currentStep) {
                    stepDiv.classList.add('active');
                } else if (step.id < currentStep) {
                    stepDiv.classList.add('completed');
                }

                const indicator = document.createElement('div');
                indicator.className = 'progress-step-indicator';
                indicator.textContent = step.id;

                const label = document.createElement('div');
                label.className = 'progress-step-label';
                label.textContent = step.label;

                if (index < steps.length - 1) {
                    const line = document.createElement('div');
                    line.className = 'progress-step-line';
                    stepDiv.appendChild(line);
                }

                stepDiv.appendChild(indicator);
                stepDiv.appendChild(label);
                progressSteps.appendChild(stepDiv);
            });

            updateProgress();
        }

        // プログレスバーの更新
        function updateProgress() {
            const percentage = ((currentStep - 1) / (totalSteps - 1)) * 100;
            document.getElementById('progressBar').style.width = percentage + '%';
            document.getElementById('currentStep').textContent = currentStep;
            document.getElementById('totalSteps').textContent = totalSteps;

            // プログレスステップの更新
            steps.forEach(step => {
                const indicator = document.getElementById(`progress-${step.id}`);
                if (indicator) {
                    indicator.classList.remove('active', 'completed');
                    if (step.id === currentStep) {
                        indicator.classList.add('active');
                    } else if (step.id < currentStep) {
                        indicator.classList.add('completed');
                    }
                }
            });
        }

        // バリデーションルール定義
        const validationRules = {
            // ステップ1: 労働者基本情報
            lastName: {
                required: true,
                pattern: /^[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+$/,
                message: '【姓】を正しく入力してください。漢字、ひらがな、カタカナのいずれかで入力してください。',
                fieldName: '姓'
            },
            firstName: {
                required: true,
                pattern: /^[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+$/,
                message: '【名】を正しく入力してください。漢字、ひらがな、カタカナのいずれかで入力してください。',
                fieldName: '名'
            },
            lastNameKana: {
                required: true,
                pattern: /^[\u30A0-\u30FF]+$/,
                message: '【姓（フリガナ）】は全角カタカナで入力してください。例：ヤマダ',
                fieldName: '姓（フリガナ）'
            },
            firstNameKana: {
                required: true,
                pattern: /^[\u30A0-\u30FF]+$/,
                message: '【名（フリガナ）】は全角カタカナで入力してください。例：タロウ',
                fieldName: '名（フリガナ）'
            },
            birthDate: {
                required: true,
                validator: function(value) {
                    if (!value) return false;
                    const date = new Date(value);
                    const today = new Date();
                    const age = today.getFullYear() - date.getFullYear();
                    return date < today && age >= 15 && age <= 100;
                },
                message: '【生年月日】を正しく入力してください。15歳以上100歳以下の日付を選択してください。',
                fieldName: '生年月日'
            },
            tel1: {
                required: true,
                pattern: /^[0-9]{2,5}$/,
                message: '【電話番号（1番目）】は2〜5桁の半角数字で入力してください。',
                fieldName: '電話番号（1番目）'
            },
            tel2: {
                required: true,
                pattern: /^[0-9]{1,4}$/,
                message: '【電話番号（2番目）】は1〜4桁の半角数字で入力してください。',
                fieldName: '電話番号（2番目）'
            },
            tel3: {
                required: true,
                pattern: /^[0-9]{4}$/,
                message: '【電話番号（3番目）】は4桁の半角数字で入力してください。',
                fieldName: '電話番号（3番目）'
            },
            postalCode: {
                required: true,
                pattern: /^[0-9]{3}-?[0-9]{4}$/,
                message: '【郵便番号】はハイフン付きの7桁で入力してください。例：123-4567',
                fieldName: '郵便番号'
            },
            address1: {
                required: true,
                minLength: 3,
                message: '【住所（都道府県・市区町村）】を入力してください。郵便番号検索ボタンで自動入力できます。',
                fieldName: '住所（都道府県・市区町村）'
            },
            address2: {
                required: true,
                minLength: 1,
                message: '【住所（番地・建物名等）】を入力してください。番地、建物名、部屋番号などを入力してください。',
                fieldName: '住所（番地・建物名等）'
            },

            // ステップ2: 労働保険番号・職種情報
            insuranceMain: {
                required: true,
                pattern: /^[0-9]{11}$/,
                message: '【労働保険番号（前半）】は11桁の数字で入力してください。',
                fieldName: '労働保険番号（前半11桁）'
            },
            insuranceBranch: {
                required: true,
                pattern: /^[0-9]{3}$/,
                message: '【労働保険番号（後半）】は3桁の数字で入力してください。',
                fieldName: '労働保険番号（後半3桁）'
            },
            occupation: {
                required: true,
                minLength: 2,
                message: '【職種】を入力してください。例：製造業、事務職、建設作業員',
                fieldName: '職種'
            },
            averageWage: {
                required: true,
                validator: function(value) {
                    const num = parseFloat(value);
                    return !isNaN(num) && num > 0 && num <= 1000000;
                },
                message: '【平均賃金（日額）】は1円以上100万円以下の数値で入力してください。',
                fieldName: '平均賃金（日額）'
            },

            // ステップ3: 災害情報
            injuryDate: {
                required: true,
                validator: function(value) {
                    if (!value) return false;
                    const date = new Date(value);
                    const today = new Date();
                    const threeYearsAgo = new Date();
                    threeYearsAgo.setFullYear(today.getFullYear() - 3);
                    return date >= threeYearsAgo && date <= today;
                },
                message: '【負傷または発病年月日】は過去3年以内の日付を入力してください。未来の日付は入力できません。',
                fieldName: '負傷または発病年月日'
            },
            injuryHour: {
                required: true,
                message: '【災害発生時刻（時）】を選択してください。',
                fieldName: '災害発生時刻（時）'
            },
            injuryMinute: {
                required: true,
                message: '【災害発生時刻（分）】を選択してください。',
                fieldName: '災害発生時刻（分）'
            },
            accidentLocation: {
                required: true,
                minLength: 3,
                message: '【災害発生場所】を具体的に入力してください。例：工場内第2作業場、事務所3階会議室',
                fieldName: '災害発生場所'
            },
            accidentDescription: {
                required: true,
                minLength: 20,
                message: '【災害発生状況】は20文字以上で詳しく記入してください。いつ、どこで、何をしている時に、どのような災害が発生したかを具体的に記入してください。',
                fieldName: '災害発生状況'
            },
            leaveStartDate: {
                required: true,
                validator: function(value) {
                    if (!value) return false;
                    const injuryDate = document.getElementById('injuryDate')?.value;
                    if (!injuryDate) return true;
                    return new Date(value) >= new Date(injuryDate);
                },
                message: '【休業開始日】は負傷または発病年月日以降の日付を入力してください。',
                fieldName: '休業開始日'
            },
            leaveEndDate: {
                required: true,
                validator: function(value) {
                    if (!value) return false;
                    const startDate = document.getElementById('leaveStartDate')?.value;
                    if (!startDate) return true;
                    return new Date(value) >= new Date(startDate);
                },
                message: '【休業終了日（予定）】は休業開始日以降の日付を入力してください。',
                fieldName: '休業終了日（予定）'
            },

            // ステップ4: 振込先情報
            bankName: {
                required: true,
                minLength: 2,
                message: '【金融機関名】を入力してください。例：三菱UFJ銀行、みずほ銀行',
                fieldName: '金融機関名'
            },
            branchName: {
                required: true,
                minLength: 2,
                message: '【支店名】を入力してください。例：本店、東京支店',
                fieldName: '支店名'
            },
            accountNumber: {
                required: true,
                pattern: /^[0-9]{1,8}$/,
                message: '【口座番号】は半角数字で1～8桁で入力してください。',
                fieldName: '口座番号'
            },
            accountHolderLastNameKana: {
                required: true,
                pattern: /^[\u30A0-\u30FF]+$/,
                message: '【口座名義人 姓（カナ）】は全角カタカナで入力してください。例：ヤマダ',
                fieldName: '口座名義人 姓（カナ）'
            },
            accountHolderFirstNameKana: {
                required: true,
                pattern: /^[\u30A0-\u30FF]+$/,
                message: '【口座名義人 名（カナ）】は全角カタカナで入力してください。例：タロウ',
                fieldName: '口座名義人 名（カナ）'
            }
        };

        // 次のステップへ
        function nextStep() {
            if (validateCurrentStep()) {
                saveCurrentStepData();
                
                document.getElementById(`step-${currentStep}`).classList.remove('active');
                currentStep++;
                
                if (currentStep <= totalSteps) {
                    const nextStepElement = document.getElementById(`step-${currentStep}`);
                    if (nextStepElement) {
                        nextStepElement.classList.add('active');
                    }
                    updateProgress();
                    window.scrollTo(0, 0);
                }
            }
        }

        // 前のステップへ
        function previousStep() {
            saveCurrentStepData();
            
            document.getElementById(`step-${currentStep}`).classList.remove('active');
            currentStep--;
            
            if (currentStep >= 1) {
                document.getElementById(`step-${currentStep}`).classList.add('active');
                updateProgress();
                window.scrollTo(0, 0);
            }
        }

        // バリデーション
        function validateCurrentStep() {
            const stepElement = document.getElementById(`step-${currentStep}`);
            const errorSummary = document.getElementById(`errorSummary${currentStep}`);
            const errorList = document.getElementById(`errorList${currentStep}`);
            let isValid = true;
            const errors = [];

            // エラー状態をリセット
            stepElement.querySelectorAll('.form-input, .form-select').forEach(input => {
                input.classList.remove('error');
            });
            stepElement.querySelectorAll('.error-message').forEach(msg => {
                msg.classList.remove('show');
            });

            // 電話番号の複合バリデーション（ステップ1の場合）
            if (currentStep === 1) {
                const telFields = ['tel1', 'tel2', 'tel3'];
                let allTelFieldsFilled = true;

                telFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if (!field || !field.value.trim()) {
                        allTelFieldsFilled = false;
                    }
                });

                if (!allTelFieldsFilled) {
                    telFields.forEach(fieldId => {
                        const field = document.getElementById(fieldId);
                        const rule = validationRules[fieldId];
                        if (rule && (!field || !field.value.trim())) {
                            if (field) field.classList.add('error');
                        }
                    });

                    const telError = document.getElementById('tel-error');
                    if (telError) {
                        telError.textContent = '【電話番号】はすべての項目を入力してください。3つの入力欄すべてに入力してください。';
                        telError.classList.add('show');
                    }
                    errors.push('電話番号のすべての項目を入力してください');
                    isValid = false;
                }
            }

            // 労働保険番号の複合バリデーション（ステップ2の場合）
            if (currentStep === 2) {
                const insuranceFields = ['insuranceMain', 'insuranceBranch'];
                let allInsuranceFieldsFilled = true;

                insuranceFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if (!field || !field.value.trim()) {
                        allInsuranceFieldsFilled = false;
                    }
                });

                if (!allInsuranceFieldsFilled) {
                    insuranceFields.forEach(fieldId => {
                        const field = document.getElementById(fieldId);
                        const rule = validationRules[fieldId];
                        if (rule && (!field || !field.value.trim())) {
                            if (field) field.classList.add('error');
                        }
                    });

                    const insuranceError = document.getElementById('insurance-error');
                    if (insuranceError) {
                        insuranceError.textContent = '【労働保険番号】はすべての項目を入力してください。前半11桁と後半3桁の両方を正しく入力してください。';
                        insuranceError.classList.add('show');
                    }
                    errors.push('労働保険番号のすべての項目を入力してください');
                    isValid = false;
                }
            }

            // 災害発生時刻の複合バリデーション（ステップ3の場合）
            if (currentStep === 3) {
                const hour = document.getElementById('injuryHour');
                const minute = document.getElementById('injuryMinute');

                if ((!hour || !hour.value) || (!minute || !minute.value)) {
                    if (hour && !hour.value) hour.classList.add('error');
                    if (minute && !minute.value) minute.classList.add('error');

                    const timeError = document.getElementById('injuryTime-error');
                    if (timeError) {
                        timeError.textContent = '【災害発生時刻】の時と分の両方を選択してください。';
                        timeError.classList.add('show');
                    }
                    errors.push('災害発生時刻を選択してください（時・分）');
                    isValid = false;
                }
            }

            // 口座種別のバリデーション（ステップ4の場合）
            if (currentStep === 4) {
                const accountTypeRadios = document.querySelectorAll('input[name="accountType"]');
                const isAccountTypeChecked = Array.from(accountTypeRadios).some(radio => radio.checked);

                if (!isAccountTypeChecked) {
                    const accountTypeError = document.getElementById('accountType-error');
                    if (accountTypeError) {
                        accountTypeError.textContent = '【口座種別】を選択してください。';
                        accountTypeError.classList.add('show');
                    }
                    errors.push('口座種別を選択してください');
                    isValid = false;
                }
            }

            // フィールドのバリデーション
            stepElement.querySelectorAll('.form-label-required').forEach(label => {
                const formGroup = label.closest('.form-group');
                const input = formGroup.querySelector('.form-input:not([type="radio"]):not([type="checkbox"])');
                const selectInput = formGroup.querySelector('.form-select');
                const radioButtons = formGroup.querySelectorAll('.form-radio');
                const targetInput = input || selectInput;

                if (targetInput) {
                    const fieldId = targetInput.id;
                    const rule = validationRules[fieldId];

                    if (rule) {
                        let hasError = false;
                        let errorMessage = '';

                        if (rule.required && !targetInput.value.trim()) {
                            hasError = true;
                            errorMessage = rule.message;
                        } else if (targetInput.value.trim()) {
                            if (rule.pattern && !rule.pattern.test(targetInput.value)) {
                                hasError = true;
                                errorMessage = rule.message;
                            } else if (rule.validator && !rule.validator(targetInput.value)) {
                                hasError = true;
                                errorMessage = rule.message;
                            } else if (rule.minLength && targetInput.value.length < rule.minLength) {
                                hasError = true;
                                errorMessage = rule.message;
                            }
                        }

                        if (hasError) {
                            isValid = false;
                            targetInput.classList.add('error');

                            const errorElement = document.getElementById(`${fieldId}-error`);
                            if (errorElement) {
                                errorElement.textContent = errorMessage;
                                errorElement.classList.add('show');
                            }

                            errors.push(errorMessage);
                        }
                    }
                } else if (radioButtons.length > 0) {
                    const isChecked = Array.from(radioButtons).some(radio => radio.checked);
                    if (!isChecked) {
                        isValid = false;
                        // ラベルテキストを取得してエラーメッセージを動的に生成
                        const labelText = label.textContent.trim();
                        const errorElement = formGroup.querySelector('.error-message');
                        if (errorElement) {
                            errorElement.textContent = `【${labelText}】を選択してください。`;
                            errorElement.classList.add('show');
                        }
                        errors.push(`${labelText}を選択してください`);
                    }
                }
            });

            // エラーサマリーの表示
            if (!isValid && errorSummary && errorList) {
                errorList.innerHTML = errors.map(err => `<li>${err}</li>`).join('');
                errorSummary.classList.add('show');

                // エラーサマリーまでスムーズスクロール
                setTimeout(() => {
                    errorSummary.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }, 100);

                // 最初のエラーフィールドにフォーカス（少し遅延させて）
                setTimeout(() => {
                    const firstErrorField = stepElement.querySelector('.form-input.error, .form-select.error');
                    if (firstErrorField) {
                        firstErrorField.focus();
                    }
                }, 500);
            } else if (errorSummary) {
                errorSummary.classList.remove('show');
            }

            return isValid;
        }

        // フォームデータの保存
        function saveCurrentStepData() {
            const stepElement = document.getElementById(`step-${currentStep}`);
            const inputs = stepElement.querySelectorAll('.form-input, .form-radio, .form-checkbox, .form-textarea');

            inputs.forEach(input => {
                if (input.type === 'radio' || input.type === 'checkbox') {
                    if (input.checked) {
                        formData[input.name || input.id] = input.value;
                    }
                } else {
                    formData[input.id] = input.value;
                }
            });

            localStorage.setItem('rosaiFormData', JSON.stringify(formData));
        }

        // フォームデータの読み込み
        function loadFormData() {
            const savedData = localStorage.getItem('rosaiFormData');
            if (savedData) {
                formData = JSON.parse(savedData);

                Object.keys(formData).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        if (element.type === 'radio' || element.type === 'checkbox') {
                            element.checked = true;
                        } else {
                            element.value = formData[key];
                        }

                        // address1が自動入力済みの場合は非活性化
                        if (key === 'address1' && formData[key]) {
                            element.disabled = true;
                            element.style.backgroundColor = 'var(--color-gray-100)';
                            element.style.cursor = 'not-allowed';
                        }
                    }
                });
            }
        }

        // 自動保存の設定
        function setupAutoSave() {
            setInterval(() => {
                saveCurrentStepData();
            }, 30000); // 30秒ごとに保存
        }

        // リアルタイムバリデーション
        function setupRealtimeValidation() {
            document.querySelectorAll('.form-input, .form-select').forEach(input => {
                input.addEventListener('blur', function() {
                    validateField(this);
                });

                input.addEventListener('input', function() {
                    if (this.classList.contains('error')) {
                        validateField(this);
                    }
                });

                input.addEventListener('change', function() {
                    if (this.classList.contains('error')) {
                        validateField(this);
                    }
                });
            });
        }

        // 個別フィールドのバリデーション
        function validateField(input) {
            const fieldId = input.id;
            const rule = validationRules[fieldId];

            if (!rule) return true;

            let isValid = true;
            let errorMessage = '';

            // 空欄チェック
            if (rule.required && !input.value.trim()) {
                isValid = false;
                errorMessage = rule.message;
            }
            // 値が入力されている場合のチェック
            else if (input.value.trim()) {
                if (rule.pattern && !rule.pattern.test(input.value)) {
                    isValid = false;
                    errorMessage = rule.message;
                } else if (rule.validator && !rule.validator(input.value)) {
                    isValid = false;
                    errorMessage = rule.message;
                } else if (rule.minLength && input.value.length < rule.minLength) {
                    isValid = false;
                    errorMessage = rule.message;
                }
            }

            const errorElement = document.getElementById(`${fieldId}-error`);
            if (!isValid) {
                input.classList.add('error');
                if (errorElement) {
                    errorElement.textContent = errorMessage;
                    errorElement.classList.add('show');
                }
            } else {
                input.classList.remove('error');
                if (errorElement) {
                    errorElement.classList.remove('show');
                }
            }

            return isValid;
        }

        // 住所検索
        async function searchAddress() {
            const postalCodeInput = document.getElementById('postalCode');
            const address1Input = document.getElementById('address1');
            const postalCode = postalCodeInput.value.replace(/[^0-9]/g, ''); // ハイフンを除去

            if (!postalCode) {
                alert('郵便番号を入力してください。');
                return;
            }

            if (postalCode.length !== 7) {
                alert('郵便番号は7桁で入力してください。');
                return;
            }

            try {
                // zipcloud APIを使用して住所を取得
                const response = await fetch(`https://zipcloud.ibsnet.co.jp/api/search?zipcode=${postalCode}`);
                const data = await response.json();

                if (data.status === 200 && data.results) {
                    const result = data.results[0];
                    const autoAddress = result.address1 + result.address2 + result.address3;
                    address1Input.value = autoAddress;

                    // 自動入力後は非活性化
                    address1Input.disabled = true;
                    address1Input.style.backgroundColor = 'var(--color-gray-100)';
                    address1Input.style.cursor = 'not-allowed';

                    // エラー表示をクリア
                    address1Input.classList.remove('error');
                    const address1Error = document.getElementById('address1-error');
                    if (address1Error) {
                        address1Error.classList.remove('show');
                    }

                    // 下段（番地等）の入力欄にフォーカス
                    const address2Input = document.getElementById('address2');
                    if (address2Input) {
                        address2Input.focus();
                    }
                } else {
                    alert('該当する住所が見つかりませんでした。郵便番号を確認してください。');
                }
            } catch (error) {
                console.error('住所検索エラー:', error);
                alert('住所検索中にエラーが発生しました。しばらく経ってから再度お試しください。');
            }
        }

        // ファイルアップロード処理
        function setupFileUpload() {
            // 診断書のファイル選択
            const medicalCertificate = document.getElementById('medicalCertificate');
            if (medicalCertificate) {
                medicalCertificate.addEventListener('change', function(e) {
                    displayFileList(e.target.files, 'medicalCertificateList');
                });
            }

            // その他書類のファイル選択
            const otherDocuments = document.getElementById('otherDocuments');
            if (otherDocuments) {
                otherDocuments.addEventListener('change', function(e) {
                    displayFileList(e.target.files, 'otherDocumentsList');
                });
            }
        }

        // ファイルリスト表示
        function displayFileList(files, listId) {
            const listElement = document.getElementById(listId);
            if (!listElement) return;

            listElement.innerHTML = '';

            Array.from(files).forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';

                const fileName = document.createElement('div');
                fileName.className = 'file-item-name';
                fileName.innerHTML = `
                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z" clip-rule="evenodd"></path>
                    </svg>
                    <span>${file.name} (${formatFileSize(file.size)})</span>
                `;

                const removeBtn = document.createElement('button');
                removeBtn.className = 'file-item-remove';
                removeBtn.textContent = '削除';
                removeBtn.type = 'button';
                removeBtn.onclick = function() {
                    fileItem.remove();
                };

                fileItem.appendChild(fileName);
                fileItem.appendChild(removeBtn);
                listElement.appendChild(fileItem);
            });
        }

        // ファイルサイズのフォーマット
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }

        // 申請の送信
        function submitApplication() {
            const finalConfirm = document.getElementById('finalConfirm');

            if (!finalConfirm.checked) {
                alert('確認事項にチェックを入れてください');
                return;
            }

            document.getElementById('loading').classList.add('active');

            setTimeout(() => {
                document.getElementById('loading').classList.remove('active');
                localStorage.removeItem('rosaiFormData');

                // 回覧完了画面へ遷移
                window.location.href = '労災アシスト回覧完了画面.html';
            }, 2000);
        }

        // ログアウト
        function logout() {
            if (confirm('ログアウトしますか？')) {
                localStorage.clear();
                window.location.href = '#';
            }
        }
    </script>
</body>
</html>