# CLAUDE.md

このファイルは、このリポジトリでコードを扱う際のClaude Code (claude.ai/code)へのガイダンスを提供します。

## プロジェクト概要

これは日本の労働者災害補償（労災）申請支援システムのプロトタイプです。複数の画面から構成される包括的なWebアプリケーションのモックアップです。

**プロジェクトタイプ**: 静的HTML/CSS/JavaScriptウェブアプリケーション  
**対象ユーザー**: 被災労働者、事業主、社会保険労務士、指定医療機関

## 現在のファイル構成

### メイン画面ファイル
- **労災アシストTOP画面_新.html** - デジタル庁デザインシステム準拠のランディングページ、4種類のユーザータイプ別ログイン、フローティングAI相談ボタン
- **労災アシストAIチャット.html** - 労災保険制度・申請手順に関するAIチャットボット画面
- **労災アシストログイン画面.html** - デジタル庁認証アプリ連携のQRコードログイン画面
- **労災アシスト手続き一覧画面.html** - 利用可能な手続きの一覧表示（8号・16号の6）
- **労災アシスト申請画面モック_ver0.04.html** - デジタル庁デザインシステム準拠の10ステップ申請フォーム（強化版バリデーション機能搭載）
- **労災アシスト回覧完了画面.html** - 回覧依頼完了画面（デジタル庁デザインシステム準拠、シンプルなテーブル形式）

### レガシーファイル
- **労災アシストTOP画面.html** - 旧TOP画面（デジタル庁デザインシステム準拠前）
- **労災アシスト申請画面モック_ver0.03.html** - 旧バージョン（基本的なバリデーション機能のみ）
- **労災アシスト申請画面モック_ver0.02.html** - 旧バージョン（単一ページ形式）
- **労災アシスト申請画面モック_ver0.02 -非活性除去版-.html** - 編集可能フィールドのみのバージョン

## 開発コマンド

これは静的HTMLプロトタイプであるため、ビルドスクリプト、テストコマンド、リンティングツールは設定されていません：

1. **アプリケーションの表示**: 各HTMLファイルをウェブブラウザで直接開く
2. **開発**: HTMLファイルを直接編集する
3. **テスト**: ウェブブラウザでの手動テスト

## 現在のプロジェクト状況

### 実装済み機能（2025年1月時点）

#### 1. TOP画面（デジタル庁デザインシステム準拠版）
- デジタル庁デザインシステム β版 v2.8.0 準拠
- Noto Sans JPフォント使用
- 公式カラーパレット（プライマリ: #0E5F9A）
- 4種類のユーザータイプ別ログイン（被災労働者、事業主、社労士、医療機関）
- 6つのサービスカード（新規申請、状況確認、履歴、医療機関検索、様式DL、AI相談）
- お知らせセクション（2025年11月-12月の未来日付）
- フローティングAI相談ボタン（スクロール追従、パルスアニメーション）
- デジタル庁公式SVGアイコン使用
- レスポンシブデザイン

#### 2. AIチャットボット画面
- 労災保険制度に関する包括的なナレッジベース
- 8つの主要トピック（労災保険、申請の流れ、必要書類、サイト利用方法、給付の種類、通勤災害、対象災害、FAQ）
- クイックアクションボタン（4種類）
- 関連リンクカード表示
- メッセージ履歴とタイムスタンプ
- リアルタイムチャットインターフェース
- デジタル庁公式SVGアイコン使用（カラフルな絵文字は不使用）

#### 3. ログイン画面
- デジタル庁認証アプリ連携
- QRコード表示（SVGで実装）
- カウントダウンタイマー
- 代替ログイン方法の提示
- QRコードクリックで手続き一覧画面へ遷移

#### 4. 手続き一覧画面
- 様式第8号（業務災害・継続）
- 様式第16号の6（通勤災害・継続）
- フィルター機能
- モノクロ＋ネイビーのシンプルなデザイン
- 申請画面ver0.04へのリンク

#### 5. 申請画面（ver0.04）- デジタル庁デザインシステム準拠版
- **デザイン**: デジタル庁デザインシステム β版 v2.8.0 完全準拠
  - Noto Sans JPフォント、公式カラーパレット、スペーシングシステム
  - モダンなUIコンポーネント（カード、ボタン、フォーム要素）
- **フォーム構造**: 10ステップの多段階フォーム
  - ステップ1: 労働者基本情報（氏名、住所、性別ラジオボタン、生年月日）
  - ステップ2: 労働保険番号・職種情報
  - ステップ3: 災害情報（発生日時、場所、状況、傷病部位、休業期間）
  - ステップ4: 振込先情報（金融機関名、支店名、口座種別ラジオボタン、口座番号、口座名義人）
  - ステップ5: 添付書類（診断書、その他書類のアップロード）
  - ステップ6: 事業主情報（スキップ可能・開発中）
  - ステップ7: 事業主証明（スキップ可能・開発中）
  - ステップ8: 医療機関情報（スキップ可能・開発中）
  - ステップ9: 診断証明（療養の現況ラジオボタン、スキップ可能・開発中）
  - ステップ10: 確認・提出
- **プログレスインジケーター**: 視覚的な進捗表示、ステップ表示、完了状態の追跡
- **強化版バリデーション機能**:
  - **包括的なバリデーションルール**: ステップ1～4で詳細な検証
  - **わかりやすいエラー表示**:
    - エラーサマリー: アイコン付き、項目別リスト表示、アニメーション効果、1回のボタンクリックで全エラー表示
    - 個別エラーメッセージ: フィールドごとに警告アイコン付き表示
    - エラーフィールドのハイライト: 赤枠表示
    - alertポップアップ不使用: すべてインラインエラー表示で統一
  - **詳細なエラーメッセージ**:
    - 【フィールド名】形式で明示
    - 具体的な修正指示（例、文字種、桁数など）
    - 日本語で分かりやすい説明
  - **リアルタイムバリデーション**:
    - フィールド離脱時（blur）に自動チェック
    - エラー状態では入力中（input）にも再チェック
    - セレクトボックスにも対応
    - ラジオボタンにも対応（性別、口座種別、療養の現況）
  - **複合バリデーション**:
    - 労働保険番号: 5つのフィールドすべての入力チェック
    - 災害発生時刻: 時・分の両方選択チェック
    - 日付の整合性: 負傷日 ≦ 休業開始日 ≦ 休業終了日
    - 口座種別: ラジオボタンの選択チェック
    - 性別: ラジオボタンの選択チェック
    - 療養の現況: ラジオボタンの選択チェック
  - **エラー時の動作**:
    - エラーサマリーまで自動スクロール
    - 最初のエラーフィールドに自動フォーカス
    - エラー解消時に即座に表示をクリア
- **開発用機能**:
  - 開発用ボタン: バリデーションをスキップして次のステップへ進む機能
  - ステップ6からの「事業主（開発用ボタン）」: 回覧完了画面へ遷移（事業主完了状態）
  - ステップ8からの「次へ（開発用ボタン）」: 回覧完了画面へ遷移（医療機関完了状態）
- **ユーザビリティ向上**:
  - 日付フィールド: プレースホルダー「例：2025-01-15」とヘルプテキスト表示
  - 郵便番号検索: インラインエラー表示による住所自動入力機能
- **データ永続化**: LocalStorageによる自動保存（30秒ごと）
- **アクセシビリティ**: ARIA属性、スクリーンリーダー対応、キーボード操作

#### 6. 回覧依頼完了画面（デジタル庁デザインシステム準拠版）
- **デザイン**: デジタル庁デザインシステム β版 v2.8.0 完全準拠
  - グレースケール基調のシンプルなデザイン
  - カラフルなアイコンや絵文字を排除
  - モノクロ基調で洗練された外観
- **機能**: 回覧依頼完了状態の表示
  - シンプルなテーブル形式で回覧状況を一覧表示
  - ステータスバッジ（入力完了/回覧中）
  - 個人情報のマスキング（**アスタリスク使用）
  - 最終更新日時の表示
- **情報表示**:
  - 申請番号の表示
  - 被災労働者、事業主、医療機関の3者の状況
  - 回覧依頼に関する注意事項（完了者に応じて動的に変更）
- **動的コンテンツ**:
  - LocalStorageの`completedBy`値に基づいて表示内容を切り替え
  - 被災労働者完了時: 「事業主と医療機関にメールで回覧依頼を送信しました」
  - 事業主完了時: 「事業主による証明が完了しました」「医療機関の入力完了後、労働基準監督署へ提出できます」
  - 医療機関完了時: 「医療機関による診断証明が完了しました」「事業主の入力完了後、労働基準監督署へ提出できます」

## アーキテクチャ

### 技術スタック
- **HTML5**: セマンティックマークアップ
- **CSS3**: モダンなレイアウト（Flexbox、Grid）
- **JavaScript**: Vanilla ES6+（フレームワーク未使用）
- **データ保存**: LocalStorage

### デザインシステム

このプロジェクトは**デジタル庁デザインシステム β版 v2.8.0**に準拠しています。

#### タイポグラフィ
- **フォントファミリー**: Noto Sans JP（Google Fonts）
- **フォントサイズ**: 本文16px、見出し20-32px
- **行送り**: 本文1.7、見出し1.4
- **ウェイト**: 400（Regular）、700（Bold）

#### カラーパレット（デジタル庁準拠）

**最新版（ver0.04、回覧完了画面など）:**
- **ブルー**: #1D4ED8（Primary）、#1E40AF（Hover）
- **グレー**: #F9FAFB（50）、#F3F4F6（100）、#E5E7EB（200）、#D1D5DB（300）、#6B7280（500）、#4B5563（600）、#111827（900）
- **成功**: #16A34A
- **エラー**: #DC2626
- **背景**: #FFFFFF（Primary）、#F9FAFB（Surface）
- **テキスト**: #111827（Primary）、#4B5563（Secondary）
- **ボーダー**: #D1D5DB

**TOP画面_新版:**
- **プライマリ**: #0E5F9A（メインカラー）
- **プライマリライト**: #1976D2
- **プライマリダーク**: #004C8C
- **テキストプライマリ**: #1A1A1C
- **テキストセカンダリ**: #4A4A4C
- **背景プライマリ**: #FFFFFF
- **背景セカンダリ**: #F5F5F7
- **背景ターシャリ**: #E8E8EA
- **ボーダー**: #D0D0D2
- **成功**: #2E7D32
- **警告**: #F57C00
- **エラー**: #C62828
- **情報**: #0288D1

**旧デザイン（レガシーファイル用）:**
- プライマリ: #004292、セカンダリ: #006db7、背景: #f5f7fa

#### スペーシング
- **xs**: 4px
- **sm**: 8px
- **md**: 16px
- **lg**: 24px
- **xl**: 32px
- **2xl**: 48px

#### UIコンポーネント
- **ボタン**: 角丸4px、ホバーエフェクト、明確な視覚フィードバック
- **カード**: 白背景、1pxボーダー、微細なシャドウ、ホバー時に上方移動
- **フォーム**: 構造化された入力フィールド、明確なラベル
- **テーブル**: シンプルな罫線、グレーの背景、見やすい行間
- **バッジ**: 角丸、控えめな色使い（グレー、グリーン）
- **アイコン**: デジタル庁公式SVGアイコン（icon/svg/フォルダ内）、currentColor使用
  - **重要**: カラフルな絵文字アイコン（👤🏢🏥など）は使用しない
  - モノクロ基調のシンプルなデザインを維持
- **ナビゲーション**: スムーズスクロール、固定配置ボタン

### 主要機能

#### フォーム処理
- リアルタイムバリデーション（テキスト、セレクト、ラジオボタン）
- エラーメッセージの日本語表示（インラインエラーのみ、alertポップアップ不使用）
- 自動保存機能（30秒ごと）
- 必須フィールドの明示

#### ユーザーワークフロー

**パターン1: 直接申請（TOP画面から）**
1. TOP画面で「申請を始める」または「新規申請」ボタンをクリック
2. 申請画面（ver0.04）へ直接遷移
3. 10ステップのフォームに入力
4. 回覧設定・提出

**パターン2: ログイン経由（手続き選択）**
1. TOP画面で「ログイン」ボタンをクリック
2. ログイン画面でQRコード認証
3. 手続き一覧画面で様式を選択（8号または16号の6）
4. 申請画面（ver0.04）へ遷移
5. 10ステップのフォームに入力
6. 回覧設定・提出

**パターン3: 開発用ワークフロー（テスト・デバッグ）**
1. 申請画面で「次へ（開発用ボタン）」を使用してバリデーションをスキップ
2. ステップ6から「事業主（開発用ボタン）」で回覧完了画面へ（事業主完了状態）
3. ステップ8から「次へ（開発用ボタン）」で回覧完了画面へ（医療機関完了状態）

**回覧ワークフロー:**
1. **被災労働者**: 申請開始 → 基本情報入力 → 回覧設定
2. **事業主**: 回覧受信 → 証明事項記入 → 承認
3. **医療機関**: 回覧受信 → 診断内容記入 → 承認
4. **最終提出**: 全承認後、労基署へ提出

## 開発ガイドライン

### コーディング規約
- インデント: 4スペース
- 文字コード: UTF-8
- 改行コード: CRLF（Windows環境）
- コメント: 日本語で記述

### フォームフィールドパターン
- **氏名**: 姓・名の分割フィールド
- **住所**: 郵便番号＋住所テキスト
- **電話番号**: 3分割フィールド（市外局番-市内局番-加入者番号）
- **日付**: HTML5 date input（プレースホルダー「例：2025-01-15」、ヘルプテキスト付き）
- **時刻**: セレクトボックス（時・分）
- **選択式**: ラジオボタン（性別、口座種別、療養の現況）

### バリデーションルール
- **必須チェック**: 空欄不可のフィールド、ラジオボタンの未選択検出
- **形式チェック**: 郵便番号、電話番号、メールアドレス
- **日付チェック**: 未来日付の制限、期間の整合性
- **文字種チェック**: 全角カナ、半角数字など
- **エラー表示**: すべてインラインエラー表示（alertポップアップ不使用）
- **リアルタイムバリデーション**: テキスト入力、セレクトボックス、ラジオボタンに対応

## 重要な注意事項

### 制限事項
- **バックエンド未実装**: APIサーバーなし
- **認証システム**: モック実装のみ
- **データベース**: なし（LocalStorageのみ）
- **メール送信**: 実装なし

### セキュリティ考慮事項
- 本番環境では適切な認証・認可の実装が必要
- 個人情報の暗号化が必要
- XSS、CSRF対策の実装が必要

## ファイル構造

```
C:\Users\rtani\ClaudeCode\RosaiAssist\
├── 労災アシストTOP画面_新.html            # デジタル庁デザインシステム準拠のメインランディングページ
├── 労災アシストAIチャット.html            # AIチャットボット画面
├── 労災アシストログイン画面.html          # QRコードログイン
├── 労災アシスト手続き一覧画面.html        # 手続き選択
├── 労災アシスト申請画面モック_ver0.04.html # 多段階申請フォーム（最新版・強化版バリデーション）
├── 労災アシスト回覧完了画面.html          # 回覧依頼完了画面（デジタル庁準拠、シンプルなテーブル形式）
├── icon/
│   └── svg/                               # デジタル庁公式SVGアイコン集
│       ├── application_fill.svg           # 申請アイコン
│       ├── documents_fill.svg             # 書類アイコン
│       ├── help_fill.svg                  # ヘルプアイコン
│       ├── work_fill.svg                  # 労働アイコン
│       └── ...                            # その他多数
├── CLAUDE.md                              # このファイル
├── 労災アシストTOP画面.html               # [レガシー] 旧TOP画面
├── 労災アシスト申請画面モック_ver0.03.html # [レガシー] 基本バリデーション版
├── 労災アシスト申請画面モック_ver0.02.html # [レガシー] 旧バージョン
├── 労災アシスト申請画面モック_ver0.02 -非活性除去版-.html # [レガシー]
└── 20251022断面/                          # アーカイブ
```

## 今後の開発計画

### フェーズ1（完了）
- ✅ 基本画面の作成
- ✅ フォームバリデーション
- ✅ 多段階フォーム実装
- ✅ 回覧ワークフロー表示
- ✅ デジタル庁デザインシステム準拠のUI実装
- ✅ AIチャットボット実装
- ✅ 画面遷移フローの整備
- ✅ デジタル庁公式アイコンの導入

### フェーズ2（次期）
- バックエンドAPI実装
- データベース設計・実装
- 認証システム実装
- メール通知機能

### フェーズ3（将来）
- モバイルアプリ対応
- 電子署名機能
- PDFエクスポート
- 多言語対応

## テスト項目

### 機能テスト
- フォーム入力・バリデーション
- 画面遷移
- LocalStorageデータ保存・復元
- エラーハンドリング

### UIテスト
- レスポンシブデザイン（PC、タブレット、スマートフォン）
- ブラウザ互換性（Chrome、Firefox、Safari、Edge）
- アクセシビリティ（スクリーンリーダー対応）

## 画面遷移図

```
労災アシストTOP画面_新.html
├── [申請を始める] → 労災アシスト申請画面モック_ver0.04.html
├── [新規申請カード] → 労災アシスト申請画面モック_ver0.04.html
├── [AI相談カード] → 労災アシストAIチャット.html
├── [フローティングボタン] → 労災アシストAIチャット.html
└── [ログイン] → 労災アシストログイン画面.html
                  └── [QRコード認証] → 労災アシスト手続き一覧画面.html
                                        ├── [様式第8号] → 労災アシスト申請画面モック_ver0.04.html
                                        └── [様式第16号の6] → 労災アシスト申請画面モック_ver0.04.html

労災アシスト申請画面モック_ver0.04.html
├── [ステップ1-5] → 通常の申請フロー
├── [ステップ6: 事業主（開発用ボタン）] → 労災アシスト回覧完了画面.html (事業主完了状態)
├── [ステップ8: 次へ（開発用ボタン）] → 労災アシスト回覧完了画面.html (医療機関完了状態)
└── [ステップ10: 提出完了] → 労災アシスト回覧完了画面.html (被災労働者完了状態)

※ ver0.04が最新版（強化版バリデーション、ラジオボタン、開発用機能搭載）
※ ver0.03以前はレガシーバージョン
```

## 参考資料

- 厚生労働省 労災保険給付関係様式
- デジタル庁デザインシステム β版 v2.8.0 (https://design.digital.go.jp/dads/)
- デジタル庁 認証ガイドライン
- デジタル庁 イラスト・アイコン素材集 (https://www.digital.go.jp/policies/servicedesign/designsystem/Illustration_Icons)
- JIS X 8341 ウェブアクセシビリティ規格